<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Form Input Data</title>
    <!-- Tambahkan link stylesheet Tailwind CSS -->
    <link href="https://cdn.jsdelivr.net/npm/tailwindcss@2.2.19/dist/tailwind.min.css" rel="stylesheet">
</head>

<body class="bg-gray-100 h-screen flex flex-col items-center justify-center">
    <div class="bg-white p-8 rounded shadow-md w-full md:w-96 mb-8">
        <h2 class="text-2xl font-bold mb-4">Input Data</h2>
    
        <form id="commentForm" class="space-y-4">
            <div>
                <label for="id" class="block text-sm font-medium text-gray-600">ID</label>
                <input type="text" id="id" name="id" class="mt-1 p-2 w-full border rounded-md">
            </div>
    
            <div>
                <label for="username" class="block text-sm font-medium text-gray-600">Username</label>
                <input type="text" id="username" name="username" class="mt-1 p-2 w-full border rounded-md">
            </div>
    
            <div>
                <label for="comment" class="block text-sm font-medium text-gray-600">Comment</label>
                <textarea id="comment" name="comment" class="mt-1 p-2 w-full border rounded-md"></textarea>
            </div>
    
            <div>
                <label for="questions" class="block text-sm font-medium text-gray-600">Questions</label>
                <input type="text" id="questions" name="questions" class="mt-1 p-2 w-full border rounded-md">
            </div>
    
            <div>
                <label for="tanggal" class="block text-sm font-medium text-gray-600">Tanggal</label>
                <input type="text" id="tanggal" name="tanggal" class="mt-1 p-2 w-full border rounded-md">
            </div>
    
            <div class="flex items-center">
                <input type="checkbox" id="status" name="status" class="mr-2">
                <label for="status" class="text-sm font-medium text-gray-600">Status</label>
            </div>
    
            <div>
                <button type="button" onclick="submitForm()" class="w-full bg-blue-500 text-white p-2 rounded-md">Submit</button>
            </div>
        </form>
    </div>
    
    <div class="bg-white p-8 rounded shadow-md w-full">
        <h2 class="text-2xl font-bold mb-4">Comments</h2>
    
        <!-- Tabel untuk menampilkan hasil API -->
        <div class="overflow-x-auto">
            <table class="min-w-full bg-white border border-gray-300">
                <thead>
                    <tr>
                        <th class="py-2 px-4 border-b">ID</th>
                        <th class="py-2 px-4 border-b">Username</th>
                        <th class="py-2 px-4 border-b">Comment</th>
                        <th class="py-2 px-4 border-b">Questions</th>
                        <th class="py-2 px-4 border-b">Tanggal</th>
                        <th class="py-2 px-4 border-b">Status</th>
                    </tr>
                </thead>
                <tbody id="commentTableBody">
                    <!-- Data dari API akan ditampilkan di sini -->
                </tbody>
            </table>
        </div>
    </div>
    
    <script>
        // Fungsi untuk mendapatkan data dari API dan menampilkan dalam tabel
        async function fetchDataAndDisplay() {
            try {
                const response = await fetch('https://asia-southeast2-testlogin-366704.cloudfunctions.net/getallcomment');
                const result = await response.json();

                // Periksa status dan pastikan data ada sebelum melanjutkan
                if (result.status && result.data) {
                    const commentTableBody = document.getElementById('commentTableBody');

                    // Mengosongkan isi tabel sebelum menambahkan data baru
                    commentTableBody.innerHTML = '';

                    // Menambahkan data ke dalam tabel
                    result.data.forEach(comment => {
                        const row = document.createElement('tr');

                        const idCell = document.createElement('td');
                        idCell.textContent = comment.id;
                        row.appendChild(idCell);

                        const usernameCell = document.createElement('td');
                        usernameCell.textContent = comment.username;
                        row.appendChild(usernameCell);

                        const commentCell = document.createElement('td');
                        commentCell.textContent = comment.comment;
                        row.appendChild(commentCell);

                        const questionsCell = document.createElement('td');
                        questionsCell.textContent = comment.questions;
                        row.appendChild(questionsCell);

                        const tanggalCell = document.createElement('td');
                        tanggalCell.textContent = comment.tanggal;
                        row.appendChild(tanggalCell);

                        const statusCell = document.createElement('td');
                        statusCell.textContent = comment.status ? 'Active' : 'Inactive';
                        row.appendChild(statusCell);

                        commentTableBody.appendChild(row);
                    });
                } else {
                    console.error('Error in response:', result.message);
                }
            } catch (error) {
                console.error('Error fetching data:', error);
            }
        }

        // Fungsi untuk mengirim formulir
        function submitForm() {
            // Mendapatkan nilai dari form
            const formData = {
                id: parseInt(document.getElementById('id').value),
                username: document.getElementById('username').value,
                comment: document.getElementById('comment').value,
                questions: document.getElementById('questions').value,
                tanggal: document.getElementById('tanggal').value,
                status: document.getElementById('status').checked,
            };

            // Melakukan request ke endpoint
            fetch('https://asia-southeast2-testlogin-366704.cloudfunctions.net/createcomment', {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json',
                },
                body: JSON.stringify(formData),
            })
                .then(response => response.json())
                .then(data => {
                    // Handle response dari server jika diperlukan
                    console.log(data);
                    // Setelah mengirim formulir, perbarui tabel dengan data terbaru
                    fetchDataAndDisplay();
                })
                .catch(error => {
                    console.error('Error:', error);
                });
        }

        // Panggil fungsi untuk pertama kali
        fetchDataAndDisplay();
    </script>
</body>

</html>
